<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width,initial-scale=1.0">
  <!-- Enable standalone/full‑screen when added to home‑screen -->
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
  <meta name="mobile-web-app-capable" content="yes">
  <meta name="theme-color" content="#111418">
  <title>ISO DIN Calculator</title>
  <style>
    :root{
      --bg:#111418;--panel:#1d2127;--panel-alt:#262b31;--text:#dfe3ea;--text-soft:#a3a9b6;--green:#28a745;--green-dark:#1f6d2b
    }
    *{box-sizing:border-box;font-family:system-ui,Helvetica,Arial,sans-serif;margin:0}
    body{background:var(--bg);color:var(--text);padding:2rem;display:flex;flex-direction:column;align-items:center;min-height:100vh}
    h1{font-size:1.75rem;margin-bottom:1.25rem;text-align:center}
    form{background:var(--panel);padding:1.5rem;border-radius:14px;box-shadow:0 6px 24px rgba(0,0,0,.4);display:grid;grid-template-columns:1fr 1fr;grid-auto-flow:row dense;gap:.9rem;max-width:360px;width:100%}
    form>div{display:flex;flex-direction:column}
    label{color:var(--text-soft);font-weight:600;margin-bottom:.25rem}
    input[type=number],select{background:var(--panel-alt);border:1px solid #3a4049;border-radius:6px;padding:.45rem .7rem;font-size:.95rem;color:var(--text);width:100%;min-width:0}
    select{appearance:none;background-image:url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='16' height='16' fill='%23a3a9b6' viewBox='0 0 16 16'%3E%3Cpath d='M4.646 5.146a.5.5 0 0 1 .708 0L8 7.793l2.646-2.647a.5.5 0 0 1 .708.708l-3 3a.5.5 0 0 1-.708 0l-3-3a.5.5 0 0 1 0-.708z'/%3E%3C/svg%3E");background-repeat:no-repeat;background-position:right .5rem center;background-size:12px}
    .hidden{display:none!important}
    #result-box{margin-top:1.5rem;background:var(--green-dark);border:1px solid var(--green);color:#e6ffef;padding:1rem 1.25rem;border-radius:10px;font-weight:700;max-width:420px;width:100%;text-align:center;min-height:2.3rem}
    @media(max-width:500px){body{padding:1rem}form{padding:1.25rem;grid-template-columns:1fr}h1{font-size:1.5rem}}
  </style>
</head>
<body>
<h1>ISO DIN Calculator</h1>
<form id="dinForm" autocomplete="off">
  <div>
    <label for="age">Age (years)</label>
    <input id="age" type="number" min="1" placeholder="32" required>
  </div>
  <div>
    <label for="type">Skier Type</label>
    <select id="type">
      <option value="1-">Type 1‑ (Very cautious)</option>
      <option value="1">Type 1 (Cautious)</option>
      <option value="2" selected>Type 2 (Moderate)</option>
      <option value="3">Type 3 (Aggressive)</option>
      <option value="3+">Type 3+ (Expert/Racer)</option>
    </select>
  </div>
  <div id="weightValContainer">
    <label for="weight">Weight</label>
    <input id="weight" type="number" min="1" placeholder="70" required>
  </div>
  <div>
    <label for="weightUnit">Weight Unit</label>
    <select id="weightUnit">
      <option value="kg">kg</option>
      <option value="lb">lb</option>
      <option value="stlb">st + lb</option>
    </select>
  </div>
  <div id="stonesContainer" class="hidden">
    <label for="stones">Stones</label>
    <input id="stones" type="number" min="0">
  </div>
  <div id="poundsContainer" class="hidden">
    <label for="extraPounds">Extra Pounds</label>
    <input id="extraPounds" type="number" min="0" max="13">
  </div>
  <div id="heightValContainer">
    <label for="height">Height</label>
    <input id="height" type="number" min="1" placeholder="152" required>
  </div>
  <div>
    <label for="heightUnit">Height Unit</label>
    <select id="heightUnit">
      <option value="cm">cm</option>
      <option value="ftin">ft + in</option>
    </select>
  </div>
  <div id="feetContainer" class="hidden">
    <label for="feet">Feet</label>
    <input id="feet" type="number" min="0">
  </div>
  <div id="inchesContainer" class="hidden">
    <label for="inches">Inches</label>
    <input id="inches" type="number" min="0" max="11">
  </div>
  <div>
    <label for="bsl">Boot Sole Length (mm)</label>
    <input id="bsl" type="number" min="80" placeholder="280" required>
  </div>
</form>
<div id="result-box">Fill in your details to see DIN…</div>
<script>
/* ---------- Salomon 2020‑21 chart data ---------- */
const weightToCode=[{min:10,max:13,code:'A'},{min:14,max:17,code:'B'},{min:18,max:21,code:'C'},{min:22,max:25,code:'D'},{min:26,max:30,code:'E'},{min:31,max:35,code:'F'},{min:36,max:41,code:'G'},{min:42,max:48,code:'H'},{min:49,max:57,code:'I'},{min:58,max:66,code:'J'},{min:67,max:78,code:'K'},{min:79,max:94,code:'L'},{min:95,max:Infinity,code:'M'}];
const heightToCode=[{max:148,code:'H'},{max:157,code:'I'},{max:166,code:'J'},{max:178,code:'K'},{max:194,code:'L'},{max:Infinity,code:'M'}];
const dinTable={A:[0.75,0.75,null,null,null,null],B:[1,1,0.75,null,null,null],C:[1.25,1.25,1,null,null,null],D:[1.75,1.5,1.5,null,null,null],E:[2,2,1.75,1.75,null,null],F:[2.5,2.5,2.25,2,1.75,1.75],G:[3,2.5,2.5,2.25,2,2],H:[3.5,3,3,2.5,2.5,2.5],I:[4.25,4,3.5,3.25,3.25,3.25],J:[5,4.75,4.5,4,4,4],K:[6,5.5,5.25,5,4.75,4.75],L:[7,6.75,6.25,6,5.75,5.5],M:[8.5,8,7.5,7,6.75,6.5],N:[10,9.5,9,8.5,8.25,8],O:[12,11.25,10.75,10.25,10,10]};
const codeOrder=['A','B','C','D','E','F','G','H','I','J','K','L','M','N','O'];
const typeOffset={'1-':-1,'1':0,'2':1,'3':2,'3+':3};
/* ---------- helpers ---------- */
const $=id=>document.getElementById(id);
const positive=v=>Number.isFinite(v)&&v>0;
function kg(){const unit=$('weightUnit').value;if(unit==='kg')return parseFloat($('weight').value);if(unit==='lb')return parseFloat($('weight').value)*0.453592;return(parseFloat($('stones').value||0)*14+parseFloat($('extraPounds').value||0))*0.453592;}
function cm(){const unit=$('heightUnit').value;if(unit==='cm')return parseFloat($('height').value);return(parseFloat($('feet').value||0)*12+parseFloat($('inches').value||0))*2.54;}
const findCode=(v,list,isW)=>isW?list.find(r=>v>=r.min&&v<=r.max)?.code:list.find(r=>v<=r.max)?.code;
const bslCol=mm=>mm<=250?0:mm<=270?1:mm<=290?2:mm<=310?3:mm<=330?4:5;
/* ---------- core calc ---------- */
function computeDIN(){
  const w=kg(),h=cm(),b=parseInt($('bsl').value,10),age=parseInt($('age').value,10);
  if(![w,h,b,age].every(positive))return 'incomplete';
  const wCode=findCode(w,weightToCode,true),hCode=findCode(h,heightToCode,false);
  if(!wCode&&!hCode)return 'out-of-range';
  const idxBase=Math.min(...[wCode,hCode].filter(Boolean).map(c=>codeOrder.indexOf(c)));
  let idx=idxBase+typeOffset[$('type').value];
  if(age<10||age>=50)idx-=1;idx=Math.max(0,Math.min(idx,codeOrder.length-1));
  const din=dinTable[codeOrder[idx]][bslCol(b)];
  return din==null?'out-of-range':din;
}
/* ---------- UI refresh ---------- */
function show(){
  const box=$('result-box');
  const res=computeDIN();
  if(res==='incomplete')box.textContent='Fill in all required fields…';
  else if(res==='out-of-range')box.textContent='Combination outside Salomon chart range – consult a technician.';
  else box.textContent=`Recommended initial DIN setting: ${res}`;
}
/* ---------- dynamic unit inputs ---------- */
function toggleWeight(){const unit=$('weightUnit').value;$('weightValContainer').classList.toggle('hidden',unit==='stlb');$('stonesContainer').classList.toggle('hidden',unit!=='stlb');$('poundsContainer').classList.toggle('hidden',unit!=='stlb');show();}
function toggleHeight(){const unit=$('heightUnit').value;$('heightValContainer').classList.toggle('hidden',unit==='ftin');$('feetContainer').classList.toggle('hidden',unit!=='ftin');$('inchesContainer').classList.toggle('hidden',unit!=='ftin');show();}
/* ---------- initialize ---------- */
document.addEventListener('DOMContentLoaded',()=>{
  document.querySelectorAll('#dinForm input,#dinForm select').forEach(inp=>{inp.addEventListener('input',show);inp.addEventListener('change',show);});
  $('weightUnit').addEventListener('change',toggleWeight);
  $('heightUnit').addEventListener('change',toggleHeight);
  show();
});
</script>
</body>
</html>
